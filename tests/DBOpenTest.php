<?php

class DBOpenTest extends \PHPUnit_Framework_TestCase {

	protected $host = '192.168.0.198';
	protected $port = 2424;
	protected $user = 'admin';
	protected $pass = 'admin';
	protected $db   = 'test';
	protected $type = 'document';


	/**
	 * Test initializing OrientDB object
	 */
	public function testDbOpenOk()
	{
		$orient = new Orientdb\Orientdb($this->host, $this->port);

		$result = $orient->DBOpen($this->db, $this->type, $this->pass, $this->pass);

		$this->assertTrue(is_array($result));
	}

	/**
	 * Test initializing OrientDB object with wrong data
	 */
	public function testWithInvalidPasswordKo()
	{
		try {
			$orient = new Orientdb\Orientdb($this->host, $this->port);
			
			$orient->DBOpen($this->db, $this->type, $this->pass, '');
		}
		catch (\Exception $e) {
			// Check the exception thrown is an instance clientException
			$this->assertEquals($e->GetMessage(), "User or password not valid for database: 'test'");
		}
	}

	/**
	 * Test initializing OrientDB object with wrong data
	 */
	public function testOPenInexistingDatabaseKo()
	{
		try {
			$orient = new Orientdb\Orientdb($this->host, $this->port);
			
			$orient->DBOpen('anydb', $this->type, $this->pass, $this->pass);
		}
		catch (\Exception $e) {
			// Check the exception thrown is an instance clientException
			$this->assertEquals($e->getCode(), 400);
		}
	}
}